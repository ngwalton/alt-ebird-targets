<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotspot Targets</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <link rel="stylesheet" href="styles.css">
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="leaflet.ajax.min.js"></script>  <!-- source: https://github.com/calvinmetcalf/leaflet-ajax/ -->
</head>
<body>
    <div id="map"></div>

    <script>
        // creates an empty map that is displayed in the div with the corresponding id
        let map = L.map('map', {
            center: [43.0167, -88.783],
            zoom: 11,
            minZoom: 10,
            zoomControl: false
        });

        // open street map base map
        let basemap = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
        });

        basemap.addTo(map);

        let co_bnds = new L.GeoJSON.AJAX("County_Boundaries_24K.geojson");
        co_bnds.addTo(map);

        // fucntion to display hotspot name, n species reported, and link to open hotspot needs
        function onEachFeature(feature, layer) {
            let popupContent =
                    `<h3>${feature.properties.locName}</h3>
                    <p><b># species: ${feature.properties.numSpeciesAllTime}</b></p>
                    <p><b><a class="needslink" target="_blank"
                        href="${feature.properties.locId}">
                        Show target species
                    </a></b></p>`;

            layer.bindPopup(popupContent);
        }

        let hotspot_geo = L.geoJSON(<%- hotspot_geo %>, {onEachFeature: onEachFeature});  // load from ebird servers
        // let hotspot_geo = new L.GeoJSON.AJAX("hotspot_list.geojson", {onEachFeature: onEachFeature});  // load from my server
        hotspot_geo.addTo(map);

        L.control.scale().addTo(map);

        L.control.zoom({position: 'topright'}).addTo(map);
    </script>
</body>
</html>